<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Literature Classifier</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --tech-primary: #0056b3;
            --tech-secondary: #00a0e3;
            --tech-accent: #ff6b00;
            --tech-dark: #1a1a1a;
            --tech-light: #f8f9fa;
        }
        
        body {
            padding-top: 2rem;
            background-color: var(--tech-light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--tech-dark);
        }
        
        .card {
            margin-bottom: 1.5rem;
            box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary));
            border: none;
            padding: 1.25rem;
        }
        
        .result-card {
            display: none;
        }
        
        .category-badge {
            font-size: 1rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: var(--tech-accent) !important;
            padding: 0.5rem 1rem;
            border-radius: 30px;
        }
        
        .progress {
            height: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 30px;
            background-color: #e9ecef;
        }
        
        .progress-bar {
            font-size: 0.875rem;
            line-height: 1.5rem;
            background: linear-gradient(90deg, var(--tech-primary), var(--tech-secondary));
        }
        
        .loading {
            display: none;
        }
        
        .btn {
            border-radius: 30px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary));
            border: none;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--tech-secondary), var(--tech-primary));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 86, 179, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--tech-accent), #ff9d00);
            border: none;
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #ff9d00, var(--tech-accent));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.3);
        }
        
        .form-control, .form-select {
            border-radius: 10px;
            padding: 0.75rem 1rem;
            border: 1px solid #ced4da;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--tech-secondary);
            box-shadow: 0 0 0 0.25rem rgba(0, 160, 227, 0.25);
        }
    </style>
</head>
<body>
    <header class="py-3 mb-4" style="background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary));">
        <div class="container">
            <div class="d-flex align-items-center justify-content-center">
                <h1 class="text-white fw-bold mb-0">TECH SPHERE 2025</h1>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="card">
                    <div class="card-header text-white">
                        <h2 class="mb-0">Medical Literature Classifier</h2>
                        <p class="mb-0 mt-2">AI + Data Challenge</p>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <form id="modelForm">
                                    <div class="mb-3">
                                        <label for="modelSelect" class="form-label">Select Model:</label>
                                        <select class="form-select" id="modelSelect" name="model">
                                            {% for model in models %}
                                            <option value="{{ model }}" {% if model == current_model %}selected{% endif %}>{{ model }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <button type="submit" class="btn" style="background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary)); color: white;">Load Model</button>
                                </form>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-info">
                                    <p><strong>Current model:</strong> <span id="currentModel">{{ current_model if current_model else 'None' }}</span></p>
                                </div>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <form id="predictionForm">
                            <div class="mb-3">
                                <label for="title" class="form-label">Article Title:</label>
                                <input type="text" class="form-control" id="title" name="title" placeholder="Enter the medical article title">
                            </div>
                            <div class="mb-3">
                                <label for="abstract" class="form-label">Abstract:</label>
                                <textarea class="form-control" id="abstract" name="abstract" rows="6" placeholder="Enter the abstract or content of the medical article"></textarea>
                            </div>
                            <button type="submit" class="btn" style="background: linear-gradient(135deg, var(--tech-accent), #ff9d00); color: white;">Classify</button>
                            <div class="loading mt-3">
                                <div class="d-flex align-items-center">
                                    <div class="spinner-border text-primary me-2" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <span>Processing...</span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="card result-card" id="resultCard">
                    <div class="card-header text-white">
                        <h3 class="mb-0">Classification Results</h3>
                    </div>
                    <div class="card-body">
                        <h4>Detected Categories:</h4>
                        <div id="categories" class="mb-4"></div>
                        
                        <h4>Probabilities by Category:</h4>
                        <div id="probabilities"></div>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <div class="card-header text-white">
                        <h3 class="mb-0">Example Texts</h3>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="examplesAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example1" aria-expanded="false">
                                        Example 1: Cardiovascular
                                    </button>
                                </h2>
                                <div id="example1" class="accordion-collapse collapse" data-bs-parent="#examplesAccordion">
                                    <div class="accordion-body">
                                        <button class="btn btn-sm mb-2 use-example" style="background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary)); color: white;" data-example="1">Use this example</button>
                                        <p><strong>Title:</strong> Advances in the treatment of heart failure</p>
                                        <p><strong>Abstract:</strong> Heart failure remains a major cause of morbidity and mortality worldwide. This study reviews recent advances in pharmacological treatment, including angiotensin-converting enzyme inhibitors, beta-blockers, and mineralocorticoid receptor antagonists. Emerging therapies such as sodium-glucose cotransporter-2 (SGLT2) inhibitors that have shown promising results in recent clinical trials are also discussed.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example2" aria-expanded="false">
                                        Example 2: Hepatorenal
                                    </button>
                                </h2>
                                <div id="example2" class="accordion-collapse collapse" data-bs-parent="#examplesAccordion">
                                    <div class="accordion-body">
                                        <button class="btn btn-sm mb-2 use-example" style="background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary)); color: white;" data-example="2">Use this example</button>
                                        <p><strong>Title:</strong> Hepatorenal syndrome: diagnosis and management</p>
                                        <p><strong>Abstract:</strong> Hepatorenal syndrome is a serious complication of advanced liver cirrhosis characterized by functional renal failure without intrinsic renal pathology. This article reviews updated diagnostic criteria and management strategies, including the use of vasoconstrictors such as terlipressin, albumin, and artificial liver support systems. The role of liver transplantation as definitive treatment and prognostic factors influencing survival in these patients are also discussed.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example3" aria-expanded="false">
                                        Example 3: Neurological
                                    </button>
                                </h2>
                                <div id="example3" class="accordion-collapse collapse" data-bs-parent="#examplesAccordion">
                                    <div class="accordion-body">
                                        <button class="btn btn-sm mb-2 use-example" style="background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary)); color: white;" data-example="3">Use this example</button>
                                        <p><strong>Title:</strong> New approaches in the treatment of Parkinson's disease</p>
                                        <p><strong>Abstract:</strong> Parkinson's disease is a progressive neurodegenerative disorder that primarily affects the motor system. This study examines emerging therapies, including new dopaminergic agonists, monoamine oxidase B inhibitors, and deep brain stimulation therapies. Advances in understanding the underlying molecular mechanisms and how these insights are leading to the development of disease-modifying therapies targeting alpha-synuclein and other key pathogenic targets are also discussed.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example4" aria-expanded="false">
                                        Example 4: Oncological
                                    </button>
                                </h2>
                                <div id="example4" class="accordion-collapse collapse" data-bs-parent="#examplesAccordion">
                                    <div class="accordion-body">
                                        <button class="btn btn-sm mb-2 use-example" style="background: linear-gradient(135deg, var(--tech-primary), var(--tech-secondary)); color: white;" data-example="4">Use this example</button>
                                        <p><strong>Title:</strong> Immunotherapy in the treatment of metastatic melanoma</p>
                                        <p><strong>Abstract:</strong> Metastatic melanoma has historically been resistant to conventional therapies. This article reviews the revolutionary impact of immune checkpoint inhibitors, such as anti-PD-1 and anti-CTLA-4 antibodies, in the treatment of advanced melanoma. Results from recent clinical trials, predictive factors of response, immune-related adverse effects, and combination strategies that are significantly improving survival in patients with this aggressive disease are discussed.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const modelForm = document.getElementById('modelForm');
            const predictionForm = document.getElementById('predictionForm');
            const resultCard = document.getElementById('resultCard');
            const categoriesDiv = document.getElementById('categories');
            const probabilitiesDiv = document.getElementById('probabilities');
            const currentModelSpan = document.getElementById('currentModel');
            const loadingDiv = document.querySelector('.loading');
            
            // Predefined examples
            const examples = {
                1: {
                    title: "Advances in the treatment of heart failure",
                    abstract: "Heart failure remains a major cause of morbidity and mortality worldwide. This study reviews recent advances in pharmacological treatment, including angiotensin-converting enzyme inhibitors, beta-blockers, and mineralocorticoid receptor antagonists. Emerging therapies such as sodium-glucose cotransporter-2 (SGLT2) inhibitors that have shown promising results in recent clinical trials are also discussed."
                },
                2: {
                    title: "Hepatorenal syndrome: diagnosis and management",
                    abstract: "Hepatorenal syndrome is a serious complication of advanced liver cirrhosis characterized by functional renal failure without intrinsic renal pathology. This article reviews updated diagnostic criteria and management strategies, including the use of vasoconstrictors such as terlipressin, albumin, and artificial liver support systems. The role of liver transplantation as definitive treatment and prognostic factors influencing survival in these patients are also discussed."
                },
                3: {
                    title: "New approaches in the treatment of Parkinson's disease",
                    abstract: "Parkinson's disease is a progressive neurodegenerative disorder that primarily affects the motor system. This study examines emerging therapies, including new dopaminergic agonists, monoamine oxidase B inhibitors, and deep brain stimulation therapies. Advances in understanding the underlying molecular mechanisms and how these insights are leading to the development of disease-modifying therapies targeting alpha-synuclein and other key pathogenic targets are also discussed."
                },
                4: {
                    title: "Immunotherapy in the treatment of metastatic melanoma",
                    abstract: "Metastatic melanoma has historically been resistant to conventional therapies. This article reviews the revolutionary impact of immune checkpoint inhibitors, such as anti-PD-1 and anti-CTLA-4 antibodies, in the treatment of advanced melanoma. Results from recent clinical trials, predictive factors of response, immune-related adverse effects, and combination strategies that are significantly improving survival in patients with this aggressive disease are discussed."
                }
            };
            
            // Load model
            modelForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(modelForm);
                
                fetch('/load_model', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        currentModelSpan.textContent = data.model;
                        alert('Model successfully loaded: ' + data.model);
                    } else {
                        alert('Error: ' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error loading the model');
                });
            });
            
            // Make prediction
            predictionForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(predictionForm);
                
                // Show loading indicator
                loadingDiv.style.display = 'block';
                resultCard.style.display = 'none';
                
                fetch('/predict', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    // Hide loading indicator
                    loadingDiv.style.display = 'none';
                    
                    if (data.success) {
                        // Show results
                        resultCard.style.display = 'block';
                        
                        // Show categories
                        categoriesDiv.innerHTML = '';
                        if (data.categories.length > 0) {
                            data.categories.forEach(category => {
                                const badge = document.createElement('span');
                                badge.className = 'badge category-badge';
                                badge.textContent = category;
                                categoriesDiv.appendChild(badge);
                            });
                        } else {
                            categoriesDiv.innerHTML = '<p>No categories detected.</p>';
                        }
                        
                        // Show probabilities
                        probabilitiesDiv.innerHTML = '';
                        const categories = Object.keys(data.probabilities);
                        categories.forEach(category => {
                            const probability = data.probabilities[category];
                            const percentage = Math.round(probability * 100);
                            
                            const progressContainer = document.createElement('div');
                            progressContainer.innerHTML = `
                                <p class="mb-1">${category}</p>
                                <div class="progress">
                                    <div class="progress-bar" 
                                         role="progressbar" 
                                         style="width: ${percentage}%; background: linear-gradient(90deg, var(--tech-primary), var(--tech-secondary));" 
                                         aria-valuenow="${percentage}" 
                                         aria-valuemin="0" 
                                         aria-valuemax="100">
                                        ${percentage}%
                                    </div>
                                </div>
                            `;
                            probabilitiesDiv.appendChild(progressContainer);
                        });
                    } else {
                        alert('Error: ' + data.error);
                    }
                })
                .catch(error => {
                    loadingDiv.style.display = 'none';
                    console.error('Error:', error);
                    alert('Error making prediction');
                });
            });
            
            // Use predefined examples
            document.querySelectorAll('.use-example').forEach(button => {
                button.addEventListener('click', function() {
                    const exampleId = this.getAttribute('data-example');
                    const example = examples[exampleId];
                    
                    document.getElementById('title').value = example.title;
                    document.getElementById('abstract').value = example.abstract;
                    
                    // Close the accordion
                    const bsCollapse = bootstrap.Collapse.getInstance(this.closest('.accordion-collapse'));
                    if (bsCollapse) {
                        bsCollapse.hide();
                    }
                });
            });
        });
    </script>
</body>
</html>